## 5.5 透明度、Alpha和合成

半透明物体可以通过多种不同的方式让光线穿过它们。对于渲染算法，这些可以大致分为基于光照和基于视图的效果。 基于光的效果是指对象导致光线衰减或转向，从而导致场景中的其他对象以不同方式被照亮和渲染的效果。基于视图的效果是呈现半透明对象本身的效果。

在本节中，我们将处理基于视图的最简单形式的透明度，其中半透明对象充当其后面对象颜色的衰减器。后续章节将讨论更精细的基于视图和基于光的效果，例如毛玻璃、光的弯曲（折射）、由于透明物体的厚度导致的光衰减，以及由于视角导致的反射率和透射率变化。

一种产生透明错觉的方法称为纱门透明[1244]。这个想法是用像素对齐的棋盘填充图案来渲染透明三角形。也就是说，三角形的每个其他像素都会被渲染，从而使其后面的对象部分可见。通常屏幕上的像素足够靠近，以至于棋盘图案本身是不可见的。这种方法的一个主要缺点是通常只有一个透明对象可以令人信服地呈现在屏幕的一个区域上。例如，如果在蓝色对象上渲染透明红色对象和透明绿色对象，则在棋盘图案上只能出现三种颜色中的两种。此外，50%的棋盘格是有限的。其他较大的像素掩码可用于给出其他百分比，但这些往往会产生可检测的图案[1245]。

也就是说，这种技术的一个优点是它的简单性。透明对象可以在任何时间以任何顺序渲染，不需要特殊的硬件。透明度问题在所有对象在它们覆盖的像素处不透明时消失。同样的想法也用于剪切纹理的抗锯齿边缘，但在亚像素级别，使用称为覆盖范围的alpha功能（[第6.6节][netlink6.6]）。

Enderton等人[423]介绍了随机透明度使用亚像素纱门掩码与随机采样相结合。通过使用随机点画图案来表示片段的alpha覆盖范围，可以创建一个合理但附带噪声的图像。请参见图5.31。每个像素需要大量样本才能使结果看起来合理，并且所有子像素样本需要大量内存。吸引人的是不需要混合，抗锯齿、透明度和任何其他产生部分覆盖像素的现象都由单一机制覆盖。

<div align = "center">

![Figure5.31]

</div>

<div align = "center">

**图5.31**. 随机透明度。产生的噪声显示在放大区域中。（图片来自NVIDIA SDK 11[1301]样本，由NVIDIA Corporation提供。）

</div>

大多数透明度算法将透明对象的颜色与其后面对象的颜色混合。为此，需要alpha混合的概念[199,387,1429]。当在屏幕上渲染对象时，RGB颜色和z-buffer深度与每个像素相关联。另一个组件，称为alpha(α)，也可以为对象覆盖的每个像素定义。Alpha是描述给定像素的对象片段的不透明度和覆盖程度的值。alpha为1.0意味着对象是不透明的，并且完全覆盖了像素的感兴趣区域；0.0表示像素完全没有被遮挡，即片段是完全透明的。

根据具体情况，像素的alpha可以表示不透明度、覆盖率或两者兼而有之。例如，肥皂泡的边缘可能覆盖四分之三的像素，即0.75，并且可能几乎是透明的，让十分之九的光线通过眼睛，所以它是不透明的十分之一，即0.1。那么它的alpha将为0.75 × 0.1 = 0.075。但是，如果我们使用MSAA或类似的抗锯齿方案，则样本本身将考虑覆盖范围。四分之三的样本会受到肥皂泡的影响。在每个样本中，我们将使用0.1的不透明度值作为alpha。



[netlink6.6]:netlink6.6

[Figure5.31]:Figure/Figure5.31.JPG
